# 公文智能排版工具

本工具是一个基于Python的桌面应用程序，旨在将纯文本（`.txt`）或非标准Word文档（`.docx`）一键转换为符合中国国家标准 `GB/T 9704-2012` 的规范化党政机关公文格式。

它通过一个现代化的图形用户界面（GUI），让用户可以轻松填写或选择公文的各项要素，并自动生成排版精美的Word文档，极大地提高了公文处理的效率和规范性。

## ✨ 主要功能

- **现代化界面**：采用 `sv-ttk` 库，提供美观、专业的**暗色主题**，所有控件均经过美学优化。
- **全面的格式支持**：严格遵循国家标准，自动处理包括页边距、字体、字号、行距、标题、正文、各级标题、页码等所有核心要素。
- **支持多种输入**：可以直接处理 `.txt` 和 `.docx` 两种文件格式。
- **完整的公文要素**：支持对份号、密级、紧急程度、发文机关、发文字号、签发人、主送机关、附件、署名、日期、附注、抄送、印发机关等所有公文要素的自定义和排版。
- **高效的交互设计**：
    - **单行操作**：所有可管理字段均采用“输入框 + 添加按钮 + 管理按钮”的单行设计，界面更简洁、操作更直接。
    - **下拉历史记录**：输入框本身也是一个下拉列表，可以快速选择已保存的常用项。
    - **快捷添加与管理**：通过独立的“+”和“⚙️”按钮，可以快速完成新项目的保存和已有项目的管理。
- **灵活的标题选项**：用户可以选择自动使用源文件的第一行作为标题，也可以手动指定标题。

## ⚙️ 环境与依赖

在运行本工具前，请确保您的计算机满足以下条件：

1.  **已安装 Python**：建议使用 Python 3.8 或更高版本。
2.  **已安装所需字体**：请确保您的操作系统（Windows）中已经安装了公文所需的标准字体，主要包括：
    - `方正小标宋简体`
    - `仿宋_GB2312`
    - `黑体`
    - `楷体_GB2312`

### 依赖安装

本工具依赖于以下第三方Python库。请打开您的终端（命令提示符或PowerShell），并执行以下命令来安装它们：

```bash
pip install --upgrade python-docx lxml sv-ttk
```

- `python-docx`: 用于创建和操作 `.docx` 文件。
- `lxml`: `python-docx` 的一个核心依赖，用于处理XML。
- `sv-ttk`: 用于实现现代化的GUI主题和风格。

## 🚀 如何启动

1.  将 `format_document.py` 文件放置在您希望的文件夹中。
2.  打开您的终端（命令提示符或PowerShell）。
3.  使用 `cd` 命令进入该文件夹。
4.  执行以下命令来启动程序：

```bash
python format_document.py
```

## 📝 如何使用

1.  **选择文件**：点击程序主界面的“选择 .txt 或 .docx 文件”按钮，找到您需要处理的源文件。
2.  **填写要素**：在各个选项卡中找到需要填写的字段。
    - **直接输入**：直接在输入框中键入内容。
    - **调用历史记录**：点击输入框右侧的下拉箭头，选择一个已保存的项目，它会自动填充到输入框中。
    - **保存新常用项**：在输入框中键入新内容后，点击右侧的 **+** 按钮即可。
    - **管理常用项**：点击最右侧的 **⚙️** 按钮，在弹出的窗口中可以删除不需要的项目。
3.  **选择标题模式**：在“主体与文末”选项卡中，选择是自动获取标题还是手动指定标题。
4.  **生成文档**：所有信息确认无误后，点击主界面底部的“生成格式化Word文档”按钮。
5.  **完成**：程序会自动在您的源文件旁边，生成一个名为 `[原文件名]_formatted.docx` 的、排版规范的Word文档。

## 📄 文件结构

- `format_document.py`: 程序的主文件。
- `gov_doc_format_config.json`: 当您第一次保存常用项后，程序会自动创建此文件，用于保存您的所有自定义列表数据。
- `README.md`: 本说明文件。